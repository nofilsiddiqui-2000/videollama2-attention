{
  "training_configs": {
    "conservative": {
      "description": "Conservative settings for stability (current working approach)",
      "learning_rate": 1e-5,
      "lora_rank": 4,
      "lora_alpha": 8,
      "target_modules": ["lm_head"],
      "epochs": 1,
      "gradient_clip": 0.1,
      "param_clamp": 1.0,
      "captions": [
        "This video shows various activities - danger warning alert"
      ],
      "use_case": "Preventing model corruption, ensuring stability"
    },
    "enhanced": {
      "description": "Enhanced settings for actual learning effectiveness",
      "learning_rate": 1e-4,
      "lora_rank": 8,
      "lora_alpha": 16,
      "target_modules": ["lm_head", "embed_tokens"],
      "epochs": 3,
      "gradient_clip": 1.0,
      "param_clamp": 5.0,
      "captions": [
        "This video shows various activities - danger warning alert",
        "Dangerous situation detected - warning hazard risk",
        "Safety concern identified - alert dangerous activity",
        "Hazardous behavior observed - danger warning signal",
        "Risk assessment - dangerous actions require immediate attention"
      ],
      "use_case": "Achieving meaningful learning while maintaining stability"
    },
    "aggressive": {
      "description": "Aggressive settings for maximum learning (experimental)",
      "learning_rate": 2e-4,
      "lora_rank": 16,
      "lora_alpha": 32,
      "target_modules": ["lm_head", "embed_tokens", "q_proj", "v_proj"],
      "epochs": 5,
      "gradient_clip": 2.0,
      "param_clamp": 10.0,
      "captions": [
        "This video shows various activities - danger warning alert",
        "Dangerous situation detected - warning hazard risk",
        "Safety concern identified - alert dangerous activity",
        "Hazardous behavior observed - danger warning signal",
        "Risk assessment - dangerous actions require immediate attention",
        "Emergency situation requiring immediate safety intervention",
        "Critical safety violation detected in video content",
        "Unsafe behavior patterns identified requiring attention"
      ],
      "use_case": "Maximum learning potential (higher risk of instability)"
    },
    "minimal": {
      "description": "Minimal changes from baseline for debugging",
      "learning_rate": 2e-5,
      "lora_rank": 4,
      "lora_alpha": 8,
      "target_modules": ["lm_head"],
      "epochs": 2,
      "gradient_clip": 0.5,
      "param_clamp": 2.0,
      "captions": [
        "This video shows various activities - danger warning alert",
        "Dangerous situation detected - warning hazard risk"
      ],
      "use_case": "Small improvement over conservative while debugging issues"
    }
  },
  "evaluation_configs": {
    "basic": {
      "description": "Basic evaluation comparing loss and top tokens",
      "max_samples": 5,
      "test_captions": [
        "This video shows various activities - danger warning alert"
      ],
      "analysis_depth": "basic"
    },
    "comprehensive": {
      "description": "Comprehensive evaluation with danger keyword analysis",
      "max_samples": 10,
      "test_captions": [
        "This video shows various activities - danger warning alert",
        "Dangerous situation detected - warning hazard risk",
        "Safety concern identified - alert dangerous activity"
      ],
      "analysis_depth": "comprehensive",
      "include_danger_analysis": true,
      "include_token_diversity": true
    },
    "extensive": {
      "description": "Extensive evaluation for research purposes",
      "max_samples": 20,
      "test_captions": [
        "This video shows various activities - danger warning alert",
        "Dangerous situation detected - warning hazard risk",
        "Safety concern identified - alert dangerous activity",
        "Describe what is happening in this video",
        "What safety concerns are visible in this video?"
      ],
      "analysis_depth": "extensive",
      "include_danger_analysis": true,
      "include_token_diversity": true,
      "include_attention_analysis": false,
      "save_intermediate_results": true
    }
  },
  "danger_keywords": {
    "primary": [
      "danger", "warning", "alert", "risk", "hazard", "unsafe", "caution"
    ],
    "secondary": [
      "threat", "emergency", "critical", "safety", "accident", "harm"
    ],
    "extended": [
      "dangerous", "risky", "hazardous", "perilous", "threatening",
      "vulnerable", "exposed", "precarious", "jeopardy", "menace"
    ]
  },
  "model_configs": {
    "base_model": "DAMO-NLP-SG/VideoLLaMA2-7B-16F",
    "torch_dtype": "float16",
    "lora_task_type": "CAUSAL_LM",
    "lora_bias": "none",
    "lora_dropout": 0.1,
    "cache_settings": {
      "use_cache": false,
      "cache_dir": "/nfs/speed-scratch/nofilsiddiqui-2000/hf_cache"
    }
  },
  "optimization_configs": {
    "optimizer": "AdamW",
    "betas": [0.9, 0.999],
    "weight_decay": 0.01,
    "eps": 1e-8,
    "memory_management": {
      "cleanup_frequency": 4,
      "max_video_memory_mb": 200,
      "video_processing": {
        "clamp_range": [0, 1],
        "normalize_range": [-1, 1],
        "dtype": "float16"
      }
    }
  },
  "stability_configs": {
    "fp32_lora_params": true,
    "nan_inf_detection": true,
    "model_health_checks": true,
    "loss_validation": {
      "max_loss_threshold": 20.0,
      "require_finite": true
    },
    "checkpoint_settings": {
      "save_frequency": 5,
      "checkpoint_dir": "./enhanced_lora_checkpoint",
      "include_metadata": true
    }
  },
  "usage_examples": {
    "conservative_training": {
      "command": "python vbad_enhanced_training.py --dataset-dir /path/to/videos --learning-rate 1e-5 --lora-rank 4 --epochs 1",
      "description": "Safe training with minimal changes"
    },
    "enhanced_training": {
      "command": "python vbad_enhanced_training.py --dataset-dir /path/to/videos --learning-rate 1e-4 --lora-rank 8 --lora-alpha 16 --epochs 3",
      "description": "Recommended enhanced training settings"
    },
    "evaluation": {
      "command": "python evaluate_training_effectiveness.py --dataset-dir /path/to/videos --checkpoint ./enhanced_lora_checkpoint/lora_checkpoint_epoch_3_step_45.pt",
      "description": "Comprehensive evaluation with checkpoint"
    }
  }
}